---

import { type Tecnologies } from '../../types'
import TecnologyCard from '../UI/TecnologyCard.astro'

let frontend: Tecnologies[] = []
let backend: Tecnologies[] = []
let devops: Tecnologies[] = []

try {
    const response = await fetch(`${import.meta.env.PUBLIC_API}/api/tecnologies`)
    const data: Tecnologies[] = await response.json();
    
    frontend = data.filter(item => item.type === 'frontend')
    backend = data.filter(item => item.type === 'backend')
    devops = data.filter(item => item.type === 'devops')
} catch(e) {
    console.log(e)
}
---

<section>

    <h2 class="text-3xl">Projects</h2>

    <div role="tablist" class="tabs tabs-bordered mt-10 text-xl">
        <a id="frontend" role="tab" class="tab tab-active">Front-end</a>
        <a id="backend" role="tab" class="tab">Back-end</a>
        <a id="devops" role="tab" class="tab">Devops</a>
    </div>
    <div id="content">
        <div id="frontendC" class="hide content-active" style="display: none;">
            <TecnologyCard data={frontend}/>
        </div>
        <div id="backendC" class="hide" style="display: none;">
            <TecnologyCard data={backend}/>
        </div>
        <div id="devopsC" class="hide" style="display: none;">
            <TecnologyCard data={devops}/>
        </div>
    </div>
</section>

<script>

    let items = document.querySelectorAll('a.tab');

    items.forEach(item => {
        item.addEventListener('click', () => {

            document.querySelector('a.tab-active')?.classList.remove('tab-active')
            item.classList.add('tab-active')

            let content: Element | null;
            
            switch(item.id) {
                case "frontend":
                    content = document.getElementById('frontendC')
                    break;
                case "backend":
                    content = document.getElementById('backendC')
                    break;
                case "devops":
                    content = document.getElementById('devopsC')
                    break;
                default:
                    content = null
            }

            if (content != null) {
                var element = document.querySelector('div.content-active')
                element?.classList.remove('content-active')
                content.classList.add('content-active')
            }
            
        })
    })
</script>

<style>
    .content-active {
        display: block !important;
    }

    .hide {
        display: none;
        animation: fade-out 500ms forwards;
    }

    .content-active {
        display: block;
        animation: fade-in 500ms forwards;
    }

    .tab-active {
        transition: all 0.3s ease-in;
    }


    @keyframes fade-out {
        100% {
            opacity: 0;
        }

        0% {
            opacity: 1;
        }
    }

    @keyframes fade-in {
        100% {
            opacity: 1;
        }

        0% {
            opacity: 0;
        }
    }

</style>